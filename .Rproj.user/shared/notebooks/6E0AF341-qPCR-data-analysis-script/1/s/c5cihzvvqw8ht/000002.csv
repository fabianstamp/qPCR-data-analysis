"0","df3 <- df3 %>% "
"0","mutate(DCT = CT_mean - Geo_HK) %>%  # calculate delta CT by subtracting the geometric mean of the house keeper genes from the individual sample CT means"
"0","  ungroup() %>% "
"0","  group_by(Gene, Condition) %>% # Group by Gene and Condition "
"0","  mutate(DCT_mean_WT = mean(DCT)) %>%  # Calculate DCT for each Condition. There might be a more elegant version to do this only for the WT animals"
"0","  ungroup() %>% "
"0","  group_by(Gene) %>% "
"0","  mutate(DDCT = DCT - DCT_mean_WT[Condition==""WT""]) %>% # subtract the DCT of the WT animals from the DCT of the individual samples (treated sample - untreated sample)"
"0","  mutate(FoldChange = 2^-(DDCT)) %>% # calculate FoldChange "
"0","  mutate(Log2FoldChange = log2(FoldChange)) # Transform onto log2 scale"
