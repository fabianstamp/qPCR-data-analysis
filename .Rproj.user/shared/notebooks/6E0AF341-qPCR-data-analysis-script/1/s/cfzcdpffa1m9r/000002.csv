"0","df2 <- df1 %>%"
"0","  gather(Gene, CT_mean,-c(Sample, Condition, all_of(HK)))  # convert to long format"
"0",""
"0","# Calculate the geometric mean of the reference genes"
"0","geo_mean <- df2 %>%  select(HK1, HK2) %>%"
"0","  gather(key = Ref, value = value,-Sample) %>%"
"0","  group_by(Sample) %>%"
"0","  summarise(Geo_HK = exp(mean(log(value))))  # calculate geometric mean of HK genes in a new column"
"1","Note: Using an external vector in selections is ambiguous.
[34mâ„¹[39m Use `all_of(HK1)` instead of `HK1` to silence this message.
[34mâ„¹[39m See <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.
[90mThis message is displayed once per session.[39m
"
"1","Note: Using an external vector in selections is ambiguous.
[34mâ„¹[39m Use `all_of(HK2)` instead of `HK2` to silence this message.
[34mâ„¹[39m See <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.
[90mThis message is displayed once per session.[39m
"
"1","[38;5;252mAdding missing grouping variables: `Sample`[39m
"
"0","# join df2 with geo_mean"
"0","df3 <- df2 %>% "
"0","inner_join(geo_mean, by = ""Sample"") # join with table containing geometric mean"
