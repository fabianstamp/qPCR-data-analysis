"0","df3 <-df3 %>% "
"0","  group_by(Condition, Gene) %>% "
"0","   mutate( N = n()) %>% # Add N number"
"0","  mutate(Condition_label = paste0(Condition,""\n"",""(N="",N,"")"")) %>% # add annotation for plots"
"0","  mutate(Condition_label = as.factor(Condition_label)) %>%  # define annotation as factor"
"0","  mutate( Experiment = as.factor(ID)) %>% "
"0","     mutate(Gene_name = str_extract(Gene, ""^.*?(?=_)""), .before = ""Gene"")  %>% # Add ""clean"" gene name for plotting"
"0","  mutate(Gene_name = ifelse(!is.na(Gene_name), Gene_name, Gene)) %>% # Create column containing only gene name by merging Gene with Gene_name if Gene_name contains ""NA"" values"
"0","  ungroup()"
"0","#head(df3)"
"0",""
